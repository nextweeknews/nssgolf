<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Beat Aidan Challenge</title>

  <style>
    :root{
      --bg1:#061C3B; --bg2:#04142E; --bg3:#020B18;
      --card-bg: rgba(15,23,42,1);
      --card-shadow: 0 32px 32px rgba(0,0,0,0.65);
      --row-bg: rgba(255,255,255,0.06);
      --row-bg-2: rgba(255,255,255,0.045);
      --text: #e9eef8;
      --title: #c7d7ff;
      --muted: rgba(255,255,255,.72);
      --link-blue: rgba(147,197,253,0.98);
      --accent: rgba(56,189,248,0.5);
      --hole-width: 58px;
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      min-height:100vh;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      color: var(--text);
      background: linear-gradient(to bottom, var(--bg1), var(--bg2), var(--bg3));
      text-transform: uppercase;
      overflow-x: hidden;
    }

    a{ color: inherit; text-decoration: none; }
    a:hover{ text-decoration: underline; text-underline-offset: 3px; }

    .topbar{
      position: sticky; top:0; z-index:10;
      border-bottom: 1px solid rgba(255,255,255,.10);
      background: rgba(3,18,42,.70);
      backdrop-filter: blur(10px);
    }
    .topbar-inner{
      max-width:1100px;
      margin:0 auto;
      padding: 14px 18px;
      display:flex;
      gap:12px;
      align-items:center;
      justify-content:space-between;
      flex-wrap:wrap;
    }
    .brand{display:flex; gap:12px; align-items:center;}

    .topbar-actions{
      display:flex;
      align-items:center;
      gap: 10px;
    }

    .unit-toggle{
      display:flex;
      align-items:center;
      gap: 8px;
      font-size: 11px;
      letter-spacing: .2em;
      font-weight: 800;
      color: rgba(226,232,240,0.75);
    }

    .toggle-switch{
      position: relative;
      display: inline-flex;
      align-items: center;
    }

    .toggle-switch input{
      opacity: 0;
      width: 0;
      height: 0;
    }

    .toggle-track{
      width: 44px;
      height: 22px;
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.4);
      background: rgba(15,23,42,0.8);
      display: inline-flex;
      align-items: center;
      padding: 2px;
      cursor: pointer;
      transition: border-color 0.2s ease, background 0.2s ease;
    }

    .toggle-thumb{
      width: 18px;
      height: 18px;
      border-radius: 999px;
      background: rgba(226,232,240,0.9);
      transition: transform 0.2s ease;
    }

    .toggle-switch input:checked + .toggle-track{
      border-color: rgba(148,163,184,0.4);
      background: rgba(15,23,42,0.8);
    }

    .toggle-switch input:checked + .toggle-track .toggle-thumb{
      transform: translateX(22px);
      background: rgba(224,242,254,0.95);
    }

    .home-btn{
      width:40px; height:40px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.15);
      background: rgba(255,255,255,.05);
      display:grid; place-items:center;
      overflow:hidden;
      text-decoration:none;
      cursor:pointer;
      flex: 0 0 auto;
    }
    .home-btn:hover{
      background: rgba(255,255,255,.08);
      border-color: rgba(255,255,255,.25);
    }
    .home-btn img{
      width: 70%;
      height: 70%;
      object-fit: contain;
      display:block;
      pointer-events:none;
    }

    .kicker{
      font-size:11px; letter-spacing:.25em; text-transform:uppercase;
      color: rgba(255,255,255,.65); font-weight:900;
    }
    .page-nav-select{
      background: rgba(2,6,23,.85);
      color: inherit;
      border: 1px solid rgba(125,211,252,.35);
      border-radius: 10px;
      padding: 6px 32px 6px 10px;
      font: inherit;
      letter-spacing: inherit;
      text-transform: uppercase;
      max-width: min(56vw, 420px);
      cursor: pointer;
    }
    .page-nav-select:focus-visible{
      outline: 2px solid rgba(125,211,252,.6);
      outline-offset: 2px;
    }


    .container{
      max-width:1100px;
      margin:0 auto;
      padding: 18px 18px 48px;
    }

    .page-title{
      font-size: 26px;
      font-weight: 900;
      letter-spacing: .02em;
      color: var(--title);
      margin: 8px 0 6px;
    }

    .page-subtitle{
      font-size: 13px;
      color: var(--muted);
      margin-bottom: 20px;
    }

    .card{
      background: var(--card-bg);
      border-radius: 20px;
      padding: 18px 18px 20px;
      box-shadow: var(--card-shadow);
    }

    .status{
      color: rgba(233,238,248,0.92);
      font-size: 16px;
      font-weight: 700;
      text-align:center;
      padding: 24px 0;
    }

    .week-card{
      background: rgba(10,22,44,0.85);
      border: 1px solid rgba(148,163,184,0.12);
      border-radius: 18px;
      padding: 16px 16px 18px;
      margin-bottom: 18px;
      position: relative;
    }

    .week-header{
      display:flex;
      align-items:center;
      justify-content:center;
      margin-bottom: 12px;
      flex-wrap: wrap;
      gap: 10px;
      text-align: center;
    }

    .week-title{
      font-size: 16px;
      font-weight: 900;
      letter-spacing: .2em;
      text-transform: uppercase;
      color: var(--title);
    }

    .week-select{
      font-size: 16px;
      font-weight: 900;
      letter-spacing: .2em;
      text-transform: uppercase;
      color: rgba(147,197,253,0.98);
      border: 1px solid rgba(148,163,184,0.25);
      padding: 8px 14px;
      border-radius: 999px;
      background: rgba(15,23,42,0.6);
      appearance: none;
      cursor: pointer;
    }

    .week-nav{
      position: absolute;
      top: 12px;
      width: 34px;
      height: 34px;
      border-radius: 12px;
      border: 1px solid rgba(148,163,184,0.35);
      background: rgba(15,23,42,0.8);
      color: rgba(226,232,240,0.9);
      display: grid;
      place-items: center;
      font-size: 16px;
      cursor: pointer;
    }
    .week-nav[disabled]{
      opacity: 0.4;
      cursor: not-allowed;
    }
    .week-prev{ left: 12px; }
    .week-next{ right: 12px; }

    .table-wrap{
      width: 100%;
      overflow-x: auto;
      border-radius: 14px;
      border: 1px solid rgba(148,163,184,0.12);
      padding-bottom: 0;
      scrollbar-gutter: stable both-edges;
    }

    .week-card .table-wrap + .table-wrap{
      margin-top: 16px;
    }

    /* ------------------------------------------
       RESULTS TABLE (Fix A: NO repeat(0, ...))
       ------------------------------------------ */
    table{
      width: calc(100% + (var(--playoff-holes, 0) * var(--hole-width, 68px)));
      min-width: 100%;
      border-collapse: collapse;
      table-layout: fixed;
    }

    /* Give the results table an explicit class */
    table.results-table thead tr,
    table.results-table tbody tr{
      display: grid;
      grid-template-columns:
        var(--pos-width, 68px)
        1fr
        repeat(9, var(--hole-width, 68px))
        var(--total-width, 72px);
    }

    /* Only add playoff columns when we *know* we have them */
    table.results-table.has-playoff thead tr,
    table.results-table.has-playoff tbody tr{
      grid-template-columns:
        var(--pos-width, 68px)
        1fr
        repeat(9, var(--hole-width, 68px))
        var(--total-width, 72px)
        repeat(var(--playoff-holes), var(--hole-width, 68px));
    }

    thead th{
      text-align: center;
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: .12em;
      padding: 6px 8px;
      color: rgba(226,232,240,0.86);
      background: rgba(15,23,42,0.9);
      border-bottom: 1px solid rgba(148,163,184,0.18);
      position: sticky;
      top: 0;
      vertical-align: middle;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    tbody td{
      padding: 10px 10px;
      text-align: center;
      font-size: 25px;
      color: rgba(226,232,240,0.92);
    }

    tbody tr{
      position: relative;
    }

    tbody tr::after{
      content: "";
      position: absolute;
      inset: 0;
      background: transparent;
      z-index: 1;
      pointer-events: none;
    }

    tbody tr.row-gold::after{
      background: rgba(250,204,21,0.12);
    }

    tbody tr.row-aidan::after{
      background: rgba(15,175,255,0.16);
    }

    tbody tr > td{
      position: relative;
      z-index: 2;
    }

    tbody tr:nth-child(odd){
      background: var(--row-bg);
    }
    tbody tr:nth-child(even){
      background: var(--row-bg-2);
    }

    tbody td.name{
      text-align: left;
      font-weight: 700;
      letter-spacing: .02em;
      color: rgba(255,255,255,0.85);
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .name-text{
      display: inline-block;
    }

    .name-buttons{
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      justify-content: center;
      gap: 1px;
      align-self: center;
    }

    tbody td.total{
      font-weight: 700;
      color: rgba(255,255,255,0.85);
    }

    th.col-name,
    th.col-total,
    td.col-name,
    td.col-total{
      background: rgba(147,197,253,0.12);
    }

    /* ------------------------------------------
       STATS TABLE (unchanged)
       ------------------------------------------ */
    .stats-table{
      width: 100%;
      min-width: 100%;
    }

    .stats-table thead tr,
    .stats-table tbody tr{
      display: grid;
      grid-template-columns: var(--pos-width, 68px) 1fr 97px 97px 100px 100px 100px 100px;
    }

    .stats-table thead tr.stats-group th{
      font-size: 11px;
      letter-spacing: .14em;
      padding: 8px 6px;
      background: rgba(30,41,59,0.85);
      border-bottom: 1px solid rgba(148,163,184,0.18);
    }

    .stats-table thead tr.stats-group th.col-pos{
      background: rgba(15,23,42,0.9);
      font-size: 12px;
      letter-spacing: .12em;
      padding: 6px 8px;
    }

    .stats-table thead tr.stats-group th.col-name{
      background: rgba(15,23,42,0.9);
      font-size: 12px;
      letter-spacing: .12em;
      padding: 6px 8px;
    }

    .stats-table thead tr.stats-group .stats-week-label{
      grid-column: 1 / span 2;
      text-align: center;
    }

    .stats-table thead tr.stats-group .stats-group-label{
      grid-column: 3 / span 6;
      text-align: center;
    }

    .stats-table tbody td{
      font-size: 25px;
      padding: 12px 10px;
    }

    .stats-table tbody td.stat-record{
      font-size: 18px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .stats-table th,
    .stats-table td{
      font-weight: 700;
    }

    .stats-table th.col-total,
    .stats-table td.col-total{
      background: transparent;
    }

    .stat-score{
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
    }

    .playoff-label{
      font-size: 11px;
      color: #4ade80;
      letter-spacing: .08em;
    }

    .hole-score.score-gold{ color: #f5d76e; }
    .hole-score.score-purple{ color: #c084fc; }
    .hole-score.score-blue{ color: #60a5fa; }
    .hole-score.score-green{ color: #4ade80; }
    .hole-score.score-red{ color: #f87171; }

    .col-pos{ width: var(--pos-width, 68px); }
    .col-name{ width: auto; }
    .col-total{ width: var(--total-width, 72px); }
    .col-hole{ width: var(--hole-width, 68px); }

    .hole-score,
    .finish-pos{
      font-weight: 700;
    }

    .finish-pos{
      color: var(--title);
    }

    .finish-gold{ color: #f5d76e; }
    .finish-silver{ color: #cbd5f5; }
    .finish-bronze{ color: #f2a65a; }

    .hole-header{
      display:flex;
      flex-direction:column;
      align-items:center;
      gap: 1px;
      line-height: 1.02;
    }

    .wind{
      display:flex;
      align-items:center;
      justify-content:center;
      gap: 2px;
      font-size: 14px;
      font-weight: 800;
      letter-spacing: .02em;
    }

    .wind-speed{
      letter-spacing: .04em;
    }

    .wind-0{ color: rgba(255,255,255,0.9); }
    .wind-low{ color: #60a5fa; }
    .wind-mid{ color: #facc15; }
    .wind-high{ color: #c0267d; }

    .pin-position{
      font-size: 6px;
      letter-spacing: .08em;
      color: rgba(148,163,184,0.75);
      text-transform: uppercase;
      white-space: nowrap;
    }

    .hole-number{
      font-size: 22px;
      font-weight: 800;
      color: rgba(226,232,240,0.86);
      letter-spacing: .04em;
    }

    .hole-score{
      padding: 0;
    }

    .score-button{
      width: 100%;
      padding: 10px 6px;
      background: transparent;
      border: none;
      color: inherit;
      font: inherit;
      letter-spacing: inherit;
      text-transform: inherit;
      cursor: pointer;
    }

    .score-button:focus-visible{
      outline: 2px solid rgba(56,189,248,0.65);
      outline-offset: -2px;
    }

    .score-button:hover{
      background: rgba(148,163,184,0.12);
    }

    .score-modal{
      position: fixed;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s ease;
      z-index: 50;
    }

    .score-modal.is-open{
      opacity: 1;
      pointer-events: auto;
    }

    .score-modal-backdrop{
      position: absolute;
      inset: 0;
      background: rgba(3,12,28,0.7);
      backdrop-filter: blur(4px);
    }

    .score-modal-dialog{
      position: relative;
      z-index: 1;
      min-width: 240px;
      max-width: 320px;
      width: calc(100% - 48px);
      border-radius: 16px;
      border: 1px solid rgba(148,163,184,0.2);
      background: rgba(10,22,44,0.98);
      padding: 16px 16px 18px;
      text-align: center;
      box-shadow: 0 24px 40px rgba(0,0,0,0.5);
    }

    .score-modal-title{
      font-size: 12px;
      letter-spacing: .2em;
      font-weight: 800;
      color: rgba(226,232,240,0.8);
      margin-bottom: 12px;
    }

    .score-modal-content{
      display: flex;
      flex-direction: column;
      gap: 8px;
      font-size: 13px;
      font-weight: 700;
      color: rgba(226,232,240,0.9);
    }

    .score-modal-holeout{
      color: rgba(59,130,246,0.95);
      font-size: 16px;
      letter-spacing: .08em;
    }

    .score-modal-green{
      color: rgba(74,222,128,0.95);
    }

    .score-modal-close{
      position: absolute;
      top: 10px;
      right: 10px;
      width: 28px;
      height: 28px;
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.35);
      background: rgba(15,23,42,0.75);
      color: rgba(226,232,240,0.9);
      font-size: 16px;
      cursor: pointer;
    }

    .beat-aidan-btn{
      margin-left: 0;
      padding: 2px 5px;
      border-radius: 999px;
      border: 1px solid rgba(250,204,21,0.7);
      background: transparent;
      color: rgba(250,204,21,0.95);
      font-size: 7px;
      font-weight: 800;
      letter-spacing: .12em;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      vertical-align: middle;
      text-transform: uppercase;
    }

    .playoff-place-btn{
      margin-left: 0;
      padding: 2px 5px;
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.7);
      background: transparent;
      color: rgba(226,232,240,0.9);
      font-size: 7px;
      font-weight: 800;
      letter-spacing: .12em;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      vertical-align: middle;
      text-transform: uppercase;
    }

    .playoff-place-gold{
      border-color: rgba(250,204,21,0.75);
      color: rgba(250,204,21,0.95);
    }

    .playoff-place-silver{
      border-color: rgba(226,232,240,0.75);
      color: rgba(226,232,240,0.95);
    }

    .playoff-place-bronze{
      border-color: rgba(251,146,60,0.75);
      color: rgba(251,146,60,0.95);
    }

    .playoff-place-blue{
      border-color: rgba(56,189,248,0.75);
      color: rgba(125,211,252,0.95);
    }

    .playoff-arrow{
      display: inline-block;
      margin-left: 6px;
      vertical-align: middle;
    }

    .hole-chip{
      display:inline-block;
      min-width: 28px;
      padding: 4px 6px;
      border-radius: 10px;
      border: 1px solid rgba(148,163,184,0.3);
      background: rgba(30,41,59,0.6);
    }

    .week-table-actions{
      display:flex;
      justify-content:flex-end;
      margin: 8px 4px 12px;
    }

    .playoff-btn{
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.35);
      background: rgba(15,23,42,0.8);
      color: rgba(226,232,240,0.9);
      font-size: 11px;
      font-weight: 800;
      letter-spacing: .16em;
      padding: 6px 12px;
      text-transform: uppercase;
      cursor: pointer;
    }

    .playoff-btn:hover{
      background: rgba(30,41,59,0.8);
    }

    .footer{
      text-align:center;
      color: rgba(148,163,184,0.6);
      font-size: 11px;
      margin-top: 22px;
      letter-spacing: .2em;
      text-transform: uppercase;
    }

    /* A tiny accessibility improvement for the table captions */
    .sr-only{
      position:absolute;
      width:1px;
      height:1px;
      padding:0;
      margin:-1px;
      overflow:hidden;
      clip:rect(0,0,0,0);
      white-space:nowrap;
      border:0;
    }
  </style>
</head>

<body>
  <div class="topbar">
    <div class="topbar-inner">
      <div class="brand">
        <a class="home-btn" href="/" aria-label="Home">
          <img src="/logos/golf.png" alt="Home" />
        </a>
        <div>
                    <select class="kicker page-nav-select" aria-label="Select page" onchange="if (this.value) window.location.href=this.value;">
            <option value="/index.html">Home</option>
            <option value="/worldopen/index.html">World Open</option>
            <option value="/proleague/index.html">Shotgun Pro League</option>
            <option value="/superleague/index.html">Super League</option>
            <option value="/lightningcup/index.html">Lightning Cup</option>
            <option value="/beataidan/index.html" selected>Beat Aidan</option>
          </select>
        </div>
      </div>

      <div class="topbar-actions">
        <label class="unit-toggle" for="wind-unit-toggle">
          <span>MPH</span>
          <span class="toggle-switch">
            <input id="wind-unit-toggle" type="checkbox" aria-label="Toggle wind speed units" />
            <span class="toggle-track">
              <span class="toggle-thumb"></span>
            </span>
          </span>
          <span>M/S</span>
        </label>
      </div>
    </div>
  </div>

  <div class="container">
    <div class="card">
      <div id="status" class="status">Loading weekly results…</div>
      <div id="weeks"></div>
    </div>

    <div class="footer">Beataidan Weekly Matches</div>
  </div>

  <div class="score-modal" id="score-modal" aria-hidden="true">
    <div class="score-modal-backdrop" data-modal-close></div>
    <div class="score-modal-dialog" role="dialog" aria-modal="true" aria-labelledby="score-modal-title">
      <button class="score-modal-close" type="button" aria-label="Close score details" data-modal-close>×</button>
      <div class="score-modal-title" id="score-modal-title">Hole Details</div>
      <div class="score-modal-content" id="score-modal-content"></div>
    </div>
  </div>

  <script>
    const WORKER_URL = "https://small-mud-2771.nextweekmedia.workers.dev/";
    const SHEET_ID = "1sbAQKwAoHzhGaRX2aI6v79wrsU7nuO7hI8xnaOexOiM";
    const SHEET_NAME = "Inputs";
    const PLAYER_STATS_SHEET = "Player Stats";
    const REFRESH_MS = 60000;
    const AIDAN_NAME = "NWN Aidan";
    const WIND_UNIT_MPH = "mph";
    const WIND_UNIT_MS = "ms";
    const WIND_MPH_TO_MS = new Map([
      [0, 0],
      [2, 1],
      [4, 2],
      [6, 3],
      [9, 4],
      [11, 5],
      [13, 6],
      [15, 7],
      [17, 8],
      [20, 9],
      [22, 10],
      [24, 11],
      [26, 12],
      [29, 13],
      [31, 14],
      [33, 15],
    ]);

    let windUnit = WIND_UNIT_MPH;
    let currentWeeks = [];

    function normalizeValues(resp){
      if(!resp) return [];
      if(Array.isArray(resp)) return resp;
      if(Array.isArray(resp.values)) return resp.values;
      if(Array.isArray(resp.data?.values)) return resp.data.values;
      if(Array.isArray(resp.result?.values)) return resp.result.values;
      return [];
    }

    async function fetchRange(a1, sheetName = SHEET_NAME){
      const range = `'${sheetName}'!${a1}`;
      const payload = { sheetId: SHEET_ID, range };

      try{
        const r = await fetch(WORKER_URL, {
          method:"POST",
          headers:{ "Content-Type":"application/json" },
          body: JSON.stringify(payload),
        });
        if(r.ok) return normalizeValues(await r.json());
      }catch(e){}

      const u = new URL(WORKER_URL);
      u.searchParams.set("sheetId", SHEET_ID);
      u.searchParams.set("range", range);
      const r2 = await fetch(u.toString());
      if(!r2.ok){
        const text = await r2.text().catch(()=> "");
        throw new Error(`Worker request failed (${r2.status}). ${text}`.trim());
      }
      return normalizeValues(await r2.json());
    }

    function isPlaceholderValue(value){
      const s = String(value ?? "").trim();
      if(s === "") return true;
      const normalized = s.toLowerCase();
      return normalized === "-" || normalized === "—" || normalized === "–" || normalized === "dc";
    }

    function normalizeHeaderValue(value){
      return isPlaceholderValue(value) ? "" : String(value ?? "").trim();
    }

    function isRowEmpty(row){
      return !row || row.every(cell => isPlaceholderValue(cell));
    }

    function formatCell(value){
      const s = String(value ?? "").trim();
      if(s === "") return "—";
      const normalized = s.toLowerCase();
      if(normalized === "dc") return "DC";
      if(normalized === "-" || normalized === "—" || normalized === "–") return "—";
      return s;
    }

    function formatScoreDisplay(value){
      const s = String(value ?? "").trim();
      if(s === "") return "—";
      const normalized = s.toLowerCase();
      if(normalized === "dc") return "DC";
      if(normalized === "-" || normalized === "—" || normalized === "–") return "—";
      if(s === "0") return "E";
      return s;
    }

    function formatHoleScoreDisplay(value){
      const s = String(value ?? "").trim();
      if(s === "") return "";
      const normalized = s.toLowerCase();
      if(normalized === "dc") return "DC";
      if(normalized === "-" || normalized === "—" || normalized === "–") return "";
      if(s === "0") return "E";
      return s;
    }

    function parseCheckboxValue(value){
      if(value === true) return true;
      if(value === false) return false;
      const normalized = String(value ?? "").trim().toLowerCase();
      if(normalized === "true") return true;
      if(normalized === "false") return false;
      return null;
    }

    function parseHoleHeader(raw){
      const text = String(raw ?? "").trim();
      const numbers = text.match(/\d+/g) ?? [];
      const letters = text.match(/[A-Za-z]+/g) ?? [];
      const holeNumber = numbers[0] ?? "";
      const windSpeed = numbers[1] ? Number.parseInt(numbers[1], 10) : null;
      const windDir = letters[1] ? letters[1].toUpperCase() : "";
      const pinCode = letters[0] ? letters[0].toUpperCase() : "";
      return {
        holeNumber,
        windSpeed: Number.isNaN(windSpeed) ? null : windSpeed,
        windDir,
        pinCode,
      };
    }

    function formatPinPosition(code){
      const map = { B: "back", F: "front", M: "middle", L: "left", R: "right" };
      return String(code ?? "")
        .split("")
        .map(letter => map[letter])
        .filter(Boolean)
        .join(" ");
    }

    function getWindArrow(direction){
      const arrows = {
        N: "↑",
        S: "↓",
        E: "→",
        W: "←",
        NE: "↗",
        NW: "↖",
        SE: "↘",
        SW: "↙",
      };
      return arrows[direction] ?? "";
    }

    function formatWindSpeed(speed){
      if(speed === null || speed === undefined) return "—";
      if(windUnit === WIND_UNIT_MS){
        const mapped = WIND_MPH_TO_MS.get(speed);
        return mapped ?? speed;
      }
      return speed;
    }

    function getWindClass(speed){
      if(speed === 0) return "wind-0";
      if(speed >= 2 && speed <= 11) return "wind-low";
      if(speed >= 13 && speed <= 22) return "wind-mid";
      if(speed >= 24 && speed <= 33) return "wind-high";
      return "";
    }

    function getFinishClass(value){
      const finish = Number.parseInt(String(value ?? "").trim(), 10);
      if(finish === 1) return "finish-gold";
      if(finish === 2) return "finish-silver";
      if(finish === 3) return "finish-bronze";
      return "";
    }

    function getPlayoffPlaceClass(value){
      const finish = Number.parseInt(String(value ?? "").trim(), 10);
      if(finish === 1) return "playoff-place-gold";
      if(finish === 2) return "playoff-place-silver";
      if(finish === 3) return "playoff-place-bronze";
      return "playoff-place-blue";
    }

    function formatOrdinalSuffix(value){
      const number = Number.parseInt(String(value ?? "").trim(), 10);
      if(Number.isNaN(number)) return "";
      const mod100 = number % 100;
      if(mod100 >= 11 && mod100 <= 13) return "th";
      switch(number % 10){
        case 1:
          return "st";
        case 2:
          return "nd";
        case 3:
          return "rd";
        default:
          return "th";
      }
    }

    function formatPlayoffLabel(value){
      const match = String(value ?? "").match(/\d+/);
      const numberText = match ? match[0] : String(value ?? "").trim();
      if(!numberText) return "PLAYOFF";
      const suffix = formatOrdinalSuffix(numberText);
      return `PLAYOFF ${numberText}${suffix}`.toUpperCase();
    }

    function normalizeName(value){
      return String(value ?? "").trim().toLowerCase();
    }

    function buildPlayerStatsMap(values){
      const map = new Map();
      values.forEach(row => {
        const name = String(row?.[0] ?? "").trim();
        if(!name || normalizeName(name) === "player") return;
        map.set(normalizeName(name), {
          name,
          vsAidan: {
            wins: row?.[1],
            losses: row?.[2],
            ties: row?.[3],
          },
          vsAll: {
            wins: row?.[5],
            losses: row?.[6],
            ties: row?.[7],
          },
          avgHole: row?.[9],
          greenPercent: row?.[10],
          savePercent: row?.[11],
          puttPercent: row?.[12],
        });
      });
      return map;
    }

    function formatRecord(record){
      const values = [record?.wins, record?.losses, record?.ties];
      if(values.every(value => String(value ?? "").trim() === "")){
        return "—";
      }
      return values
        .map(value => String(value ?? "").trim() || "0")
        .join("-");
    }

    function formatPercent(value){
      if(value === null || value === undefined || Number.isNaN(value)) return "—";
      const rounded = Math.round(value * 10) / 10;
      if(Number.isInteger(rounded)){
        return `${rounded}%`;
      }
      return `${rounded.toFixed(1)}%`;
    }

    function parseStatNumber(value){
      if(value === null || value === undefined) return null;
      const cleaned = String(value).trim().replace(/%$/, "");
      if(cleaned === "") return null;
      const parsed = Number.parseFloat(cleaned);
      return Number.isNaN(parsed) ? null : parsed;
    }

    function lerp(a, b, t){
      return Math.round(a + (b - a) * t);
    }

    function colorForScale(value, minValue, midValue, maxValue){
      if(value === null || value === undefined || Number.isNaN(value)) return "";
      const red = { r: 248, g: 113, b: 113 };
      const yellow = { r: 250, g: 204, b: 21 };
      const green = { r: 74, g: 222, b: 128 };

      const ascending = minValue < maxValue;
      const lowerBound = ascending ? minValue : maxValue;
      const upperBound = ascending ? maxValue : minValue;

      if(value <= lowerBound){
        return `rgb(${ascending ? red.r : green.r}, ${ascending ? red.g : green.g}, ${ascending ? red.b : green.b})`;
      }
      if(value >= upperBound){
        return `rgb(${ascending ? green.r : red.r}, ${ascending ? green.g : red.g}, ${ascending ? green.b : red.b})`;
      }

      let from = red;
      let to = yellow;
      let t = 0;

      if(ascending){
        if(value >= midValue){
          from = yellow;
          to = green;
          t = (value - midValue) / (maxValue - midValue);
        }else{
          from = red;
          to = yellow;
          t = (value - minValue) / (midValue - minValue);
        }
      }else{
        if(value <= midValue){
          from = yellow;
          to = green;
          t = (midValue - value) / (midValue - maxValue);
        }else{
          from = red;
          to = yellow;
          t = (minValue - value) / (minValue - midValue);
        }
      }

      const r = lerp(from.r, to.r, t);
      const g = lerp(from.g, to.g, t);
      const b = lerp(from.b, to.b, t);
      return `rgb(${r}, ${g}, ${b})`;
    }

    function getParForHole(value){
      const holeNumber = Number.parseInt(String(value ?? "").trim(), 10);
      if(Number.isNaN(holeNumber)) return null;
      const parMap = {
        1: 4, 2: 3, 3: 5, 4: 3, 5: 5, 6: 4, 7: 4, 8: 3, 9: 5,
        10: 4, 11: 3, 12: 5, 13: 3, 14: 5, 15: 4, 16: 4, 17: 3, 18: 5,
        19: 4, 20: 4, 21: 4,
      };
      return parMap[holeNumber] ?? null;
    }

    function renderHoleHeader(hole){
      const windSpeed = hole.windSpeed;
      const windText = `${formatWindSpeed(windSpeed)}`;
      const windClass = getWindClass(windSpeed);
      const arrow = windSpeed && windSpeed > 0 ? getWindArrow(hole.windDir) : "";
      const pinText = formatPinPosition(hole.pinCode);
      const holeNumber = hole.holeNumber || "—";
      const holePar = getParForHole(holeNumber);

      return `
        <div class="hole-header">
          <div class="wind ${windClass}">
            ${arrow ? `<span class="wind-arrow">${arrow}</span>` : ""}
            <span class="wind-speed">${escapeHtml(windText)}</span>
          </div>
          <div class="pin-position">${escapeHtml(pinText || "—")}</div>
          <div class="hole-number">${escapeHtml(holeNumber)}</div>
          ${holePar ? `
            <div class="pin-position">par ${holePar}</div>
          ` : ""}
        </div>
      `;
    }

    function getScoreClass(value){
      const score = Number.parseInt(String(value ?? "").trim(), 10);
      if(Number.isNaN(score)) return "";
      if(score <= -3) return "score-gold";
      if(score === -2) return "score-purple";
      if(score === -1) return "score-blue";
      if(score === 0) return "score-green";
      if(score >= 1) return "score-red";
      return "";
    }

    function parseWeeks(values){
      const weeks = [];
      const blockSize = 9; // header + 8 players

      for(let i=0; i < values.length; i += blockSize){
        const header = values[i] ?? [];
        const players = values.slice(i + 1, i + 1 + 8);
        if(isRowEmpty(header) && players.every(isRowEmpty)){
          continue;
        }

        const weekNumber = (() => {
          for(const row of players){
            const w = String(row?.[0] ?? "").trim();
            if(w) return w;
          }
          return String(header?.[0] ?? "").trim() || "—";
        })();

        const holeColumns = [];
        const maxCols = Math.max(
          header.length,
          ...players.map(row => row?.length ?? 0),
        );

        for(let col = 4; col < maxCols; col += 5){
          const headerValue = normalizeHeaderValue(header?.[col]);
          const hasPlayerValue = players.some(row => !isPlaceholderValue(row?.[col]));
          if(!headerValue && !hasPlayerValue){
            continue;
          }
          const holeMeta = parseHoleHeader(headerValue);
          holeColumns.push({
            col,
            holeNumber: holeMeta.holeNumber || "—",
            windSpeed: holeMeta.windSpeed,
            windDir: holeMeta.windDir,
            pinCode: holeMeta.pinCode,
          });
        }

        const playerRows = players
          .filter(row => !isRowEmpty(row))
          .map(row => {
            const finish = formatCell(row?.[1]);
            const finishValue = Number.parseInt(String(finish ?? "").trim(), 10);
            const name = formatCell(row?.[3]);
            return {
              finish,
              finishValue,
              name,
              isAidan: String(name).toLowerCase() === AIDAN_NAME.toLowerCase(),
              total: row?.[2] ?? "",
              holes: holeColumns.map(hole => {
                const baseCol = hole.col;
                return {
                  score: row?.[baseCol] ?? "",
                  greenHit: row?.[baseCol + 1] ?? "",
                  holeOut: row?.[baseCol + 2] ?? "",
                  putts: row?.[baseCol + 3] ?? "",
                  events: row?.[baseCol + 4] ?? "",
                };
              }),
            };
          })
          .sort((a, b) => {
            const aScore = Number.isNaN(a.finishValue) ? Number.POSITIVE_INFINITY : a.finishValue;
            const bScore = Number.isNaN(b.finishValue) ? Number.POSITIVE_INFINITY : b.finishValue;
            if(aScore === bScore && a.isAidan !== b.isAidan){
              return a.isAidan ? -1 : 1;
            }
            return aScore - bScore;
          });

        if(playerRows.length){
          weeks.push({
            weekNumber,
            holeColumns,
            playerRows,
          });
        }
      }

      return weeks;
    }

    function getWeekSortValue(week){
      const match = String(week.weekNumber ?? "").match(/\d+/);
      return match ? Number.parseInt(match[0], 10) : -1;
    }

    function renderWeek(weeks, index){
      const container = document.getElementById("weeks");
      container.innerHTML = "";

      if(!weeks.length){
        container.innerHTML = `<div class="status">No match data available yet.</div>`;
        return;
      }

      const week = weeks[index];
      if(!week){
        container.innerHTML = `<div class="status">No match data available yet.</div>`;
        return;
      }

      const mainHoles = week.holeColumns.slice(0, 9);
      const playoffHoles = week.holeColumns.slice(9);
      const hasPlayoff = playoffHoles.length > 0;

      const card = document.createElement("div");
      card.className = "week-card";

      const aidanFinish = week.playerRows.find(player => player.isAidan)?.finishValue;

      /* IMPROVED MARKUP:
         - results table uses .results-table + optional .has-playoff
         - includes a caption (screen-reader only)
         - th includes scope="col" to be more semantic
      */
      card.innerHTML = `
        <button class="week-nav week-prev" type="button" aria-label="Previous week" ${index === 0 ? "disabled" : ""}>‹</button>
        <button class="week-nav week-next" type="button" aria-label="Next week" ${index === weeks.length - 1 ? "disabled" : ""}>›</button>

        <div class="week-header">
          <select class="week-select" aria-label="Select week">
            ${weeks.map((entry, i) => `
              <option value="${i}" ${i === index ? "selected" : ""}>Week ${escapeHtml(entry.weekNumber)}</option>
            `).join("")}
          </select>
        </div>

        ${hasPlayoff ? `
          <div class="week-table-actions">
            <button class="playoff-btn" type="button">
              <span>Playoff</span>
              <span class="playoff-arrow">›</span>
            </button>
          </div>
        ` : ""}

        <div class="table-wrap">
          <table
            class="results-table ${hasPlayoff ? "has-playoff" : ""}"
            style="--playoff-holes:${playoffHoles.length};"
            aria-label="Weekly results"
          >
            <caption class="sr-only">Weekly results table</caption>
            <thead>
              <tr>
                <th class="col-pos" scope="col">Pos.</th>
                <th class="col-name" scope="col">Player</th>
                ${mainHoles.map(hole => `<th class="col-hole" scope="col">${renderHoleHeader(hole)}</th>`).join("")}
                <th class="col-total" scope="col">Score</th>
                ${playoffHoles.map(hole => `<th class="col-hole" scope="col">${renderHoleHeader(hole)}</th>`).join("")}
              </tr>
            </thead>
            <tbody>
              ${week.playerRows.map(player => {
                const hasValidAidanFinish = Number.isFinite(aidanFinish);
                const hasValidFinish = Number.isFinite(player.finishValue);
                const isBetterThanAidan = hasValidAidanFinish && hasValidFinish && player.finishValue < aidanFinish;

                const rowClass = [
                  isBetterThanAidan ? "row-gold" : "",
                  player.isAidan ? "row-aidan" : "",
                ].filter(Boolean).join(" ");

                const starButton = isBetterThanAidan
                  ? `<button class="beat-aidan-btn" type="button" aria-label="Beat Aidan">Beat Aidan</button>`
                  : "";

                const playoffScores = playoffHoles.some((hole, i) => {
                  const score = String(player.holes[i + 9]?.score ?? "").trim();
                  return score !== "";
                });

                const playoffButton = hasPlayoff && playoffScores
                  ? `<button class="playoff-place-btn ${getPlayoffPlaceClass(player.finish)}" type="button" aria-label="${escapeHtml(formatPlayoffLabel(player.finish))}">${escapeHtml(formatPlayoffLabel(player.finish))}</button>`
                  : "";

                const nameButtons = [starButton, playoffButton].filter(Boolean).join("");

                return `
                  <tr class="${rowClass}">
                    <td class="finish-pos col-pos ${getFinishClass(player.finish)}">${escapeHtml(player.finish)}</td>
                    <td class="name col-name">
                      <span class="name-text">${escapeHtml(player.name)}</span>
                      ${nameButtons ? `<div class="name-buttons">${nameButtons}</div>` : ""}
                    </td>

                    ${mainHoles.map((hole, i) => {
                      const holeData = player.holes[i] ?? {};
                      const scoreValue = holeData.score ?? "";
                      return `<td class="hole-score col-hole ${getScoreClass(scoreValue)}"
                        data-hole-number="${escapeHtml(hole.holeNumber)}"
                        data-green-hit="${escapeHtml(holeData.greenHit ?? "")}"
                        data-putts="${escapeHtml(holeData.putts ?? "")}"
                        data-events="${escapeHtml(holeData.events ?? "")}"
                        data-hole-out="${escapeHtml(holeData.holeOut ?? "")}"
                      >
                        <button class="score-button" type="button">${escapeHtml(formatHoleScoreDisplay(scoreValue))}</button>
                      </td>`;
                    }).join("")}

                    <td class="total col-total">${escapeHtml(formatScoreDisplay(player.total))}</td>

                    ${playoffHoles.map((hole, i) => {
                      const holeData = player.holes[i + 9] ?? {};
                      const scoreValue = holeData.score ?? "";
                      return `<td class="hole-score col-hole ${getScoreClass(scoreValue)}"
                        data-hole-number="${escapeHtml(hole.holeNumber)}"
                        data-green-hit="${escapeHtml(holeData.greenHit ?? "")}"
                        data-putts="${escapeHtml(holeData.putts ?? "")}"
                        data-events="${escapeHtml(holeData.events ?? "")}"
                        data-hole-out="${escapeHtml(holeData.holeOut ?? "")}"
                      >
                        <button class="score-button" type="button">${escapeHtml(formatHoleScoreDisplay(scoreValue))}</button>
                      </td>`;
                    }).join("")}
                  </tr>
                `;
              }).join("")}
            </tbody>
          </table>
        </div>

        <div class="table-wrap">
          <table class="stats-table" aria-label="Weekly stats">
            <caption class="sr-only">Weekly stats table</caption>
            <thead>
              <tr class="stats-group">
                <th class="stats-week-label" scope="col" colspan="2">Week ${escapeHtml(week.week)} Results</th>
                <th class="stats-group-label" scope="col" colspan="6">Statistics Across All Weeks</th>
              </tr>
              <tr>
                <th class="col-pos" scope="col">Pos.</th>
                <th class="col-name" scope="col">Player</th>
                <th scope="col">Vs. Aidan</th>
                <th scope="col">Vs. All Players</th>
                <th scope="col">Avg. Hole Score</th>
                <th scope="col">Green %</th>
                <th scope="col">Save %</th>
                <th scope="col">Putt %</th>
              </tr>
            </thead>
            <tbody>
              ${week.playerRows.map(player => {
                const hasValidAidanFinish = Number.isFinite(aidanFinish);
                const hasValidFinish = Number.isFinite(player.finishValue);
                const isBetterThanAidan = hasValidAidanFinish && hasValidFinish && player.finishValue < aidanFinish;

                const rowClass = [
                  isBetterThanAidan ? "row-gold" : "",
                  player.isAidan ? "row-aidan" : "",
                ].filter(Boolean).join(" ");

                const starButton = isBetterThanAidan
                  ? `<button class="beat-aidan-btn" type="button" aria-label="Beat Aidan">Beat Aidan</button>`
                  : "";

                const playerStats = playerStatsMap.get(normalizeName(player.name));
                const playoffScores = playoffHoles.some((hole, i) => {
                  const score = String(player.holes[i + 9]?.score ?? "").trim();
                  return score !== "";
                });

                const playoffButton = hasPlayoff && playoffScores
                  ? `<button class="playoff-place-btn ${getPlayoffPlaceClass(player.finish)}" type="button" aria-label="${escapeHtml(formatPlayoffLabel(player.finish))}">${escapeHtml(formatPlayoffLabel(player.finish))}</button>`
                  : "";

                const nameButtons = [starButton, playoffButton].filter(Boolean).join("");

                const avgHole = playerStats?.avgHole;
                const vsAidanText = player.isAidan ? "" : formatRecord(playerStats?.vsAidan);

                const avgHoleValue = parseStatNumber(avgHole);
                const avgHoleColor = Number.isFinite(avgHoleValue)
                  ? colorForScale(avgHoleValue, -0.5, -0.9, -1.3)
                  : "";

                const greenPercentValue = parseStatNumber(playerStats?.greenPercent);
                const savePercentValue = parseStatNumber(playerStats?.savePercent);
                const puttPercentValue = parseStatNumber(playerStats?.puttPercent);

                const greenPercentColor = colorForScale(greenPercentValue, 50, 75, 100);
                const puttPercentColor = colorForScale(puttPercentValue, 50, 75, 100);
                const savePercentColor = colorForScale(savePercentValue, 0, 25, 50);

                return `
                  <tr class="${rowClass}">
                    <td class="finish-pos col-pos ${getFinishClass(player.finish)}">${escapeHtml(player.finish)}</td>
                    <td class="name col-name">
                      <span class="name-text">${escapeHtml(player.name)}</span>
                      ${nameButtons ? `<div class="name-buttons">${nameButtons}</div>` : ""}
                    </td>
                    <td class="stat-record">${escapeHtml(vsAidanText)}</td>
                    <td class="stat-record">${escapeHtml(formatRecord(playerStats?.vsAll))}</td>
                    <td style="${avgHoleColor ? `color: ${avgHoleColor};` : ""}">${escapeHtml(formatCell(avgHole))}</td>
                    <td style="${greenPercentColor ? `color: ${greenPercentColor};` : ""}">${escapeHtml(formatPercent(greenPercentValue))}</td>
                    <td style="${savePercentColor ? `color: ${savePercentColor};` : ""}">${escapeHtml(formatPercent(savePercentValue))}</td>
                    <td style="${puttPercentColor ? `color: ${puttPercentColor};` : ""}">${escapeHtml(formatPercent(puttPercentValue))}</td>
                  </tr>
                `;
              }).join("")}
            </tbody>
          </table>
        </div>
      `;

      container.appendChild(card);

      const select = card.querySelector(".week-select");
      const prevBtn = card.querySelector(".week-prev");
      const nextBtn = card.querySelector(".week-next");
      const playoffBtn = card.querySelector(".playoff-btn");
      const tableWrap = card.querySelector(".table-wrap");

      select?.addEventListener("change", (event) => {
        const target = event.target;
        const nextIndex = Number.parseInt(target.value, 10);
        if(Number.isNaN(nextIndex)) return;
        currentWeekIndex = nextIndex;
        renderWeek(weeks, currentWeekIndex);
      });

      prevBtn?.addEventListener("click", () => {
        if(currentWeekIndex <= 0) return;
        currentWeekIndex -= 1;
        renderWeek(weeks, currentWeekIndex);
      });

      nextBtn?.addEventListener("click", () => {
        if(currentWeekIndex >= weeks.length - 1) return;
        currentWeekIndex += 1;
        renderWeek(weeks, currentWeekIndex);
      });

      playoffBtn?.addEventListener("click", () => {
        if(!tableWrap) return;
        tableWrap.scrollTo({ left: tableWrap.scrollWidth, behavior: "smooth" });
      });

      const scoreButtons = card.querySelectorAll(".hole-score .score-button");
      scoreButtons.forEach(button => {
        button.addEventListener("click", () => {
          const cell = button.closest(".hole-score");
          if(!cell) return;
          openScoreModal({
            holeNumber: cell.dataset.holeNumber || "—",
            greenHit: cell.dataset.greenHit ?? "",
            putts: cell.dataset.putts ?? "",
            events: cell.dataset.events ?? "",
            holeOut: cell.dataset.holeOut ?? "",
          });
        });
      });
    }

    function formatEventLabel(code){
      const key = String(code ?? "").trim().toLowerCase();
      const map = {
        xsv: "Missed Save",
        sv: "Made Save",
        xfp: "Missed Off-Green Putt",
        fp: "Made Off-Green Putt",
        ph: "Pin Hit",
        lr: "Launch Roll",
        xfw: "Fairway Missed",
        pl: "Pin Launch",
        ll: "Lip Launch",
      };
      return map[key] ?? code;
    }

    function openScoreModal(data){
      const modal = document.getElementById("score-modal");
      const modalTitle = document.getElementById("score-modal-title");
      const modalContent = document.getElementById("score-modal-content");
      if(!modal || !modalTitle || !modalContent) return;

      const holeOut = parseCheckboxValue(data.holeOut);
      const greenHit = parseCheckboxValue(data.greenHit);
      const puttsValue = String(data.putts ?? "").trim();
      const eventsRaw = String(data.events ?? "").trim();

      modalTitle.textContent = `Hole ${data.holeNumber || "—"} Details`;
      modalContent.innerHTML = "";

      if(holeOut){
        const line = document.createElement("div");
        line.className = "score-modal-holeout";
        line.textContent = "HOLE OUT!";
        modalContent.appendChild(line);
      }else{
        const lines = [];
        if(greenHit){
          lines.push({ text: "GREEN HIT", className: "score-modal-green" });
        }
        lines.push({ text: `PUTTS: ${puttsValue || "—"}` });

        if(eventsRaw){
          const events = eventsRaw
            .split(",")
            .map(entry => entry.trim())
            .filter(Boolean)
            .map(entry => formatEventLabel(entry));
          events.forEach(eventLabel => {
            lines.push({ text: eventLabel });
          });
        }

        if(!lines.length){
          lines.push({ text: "No details available." });
        }

        lines.forEach(lineInfo => {
          const line = document.createElement("div");
          line.textContent = lineInfo.text;
          if(lineInfo.className){
            line.className = lineInfo.className;
          }
          modalContent.appendChild(line);
        });
      }

      modal.classList.add("is-open");
      modal.setAttribute("aria-hidden", "false");
    }

    function closeScoreModal(){
      const modal = document.getElementById("score-modal");
      if(!modal) return;
      modal.classList.remove("is-open");
      modal.setAttribute("aria-hidden", "true");
    }

    function setupScoreModal(){
      const modal = document.getElementById("score-modal");
      if(!modal) return;
      modal.querySelectorAll("[data-modal-close]").forEach(trigger => {
        trigger.addEventListener("click", () => closeScoreModal());
      });
      document.addEventListener("keydown", (event) => {
        if(event.key !== "Escape") return;
        closeScoreModal();
      });
    }

    function escapeHtml(s){
      return String(s ?? "")
        .replace(/&/g,"&amp;")
        .replace(/</g,"&lt;")
        .replace(/>/g,"&gt;")
        .replace(/"/g,"&quot;")
        .replace(/'/g,"&#39;");
    }

    function setupWindToggle(){
      const toggle = document.getElementById("wind-unit-toggle");
      if(!toggle) return;
      toggle.checked = windUnit === WIND_UNIT_MS;
      toggle.onchange = () => {
        windUnit = toggle.checked ? WIND_UNIT_MS : WIND_UNIT_MPH;
        renderWeek(currentWeeks, currentWeekIndex);
      };
    }

    async function load(){
      const status = document.getElementById("status");
      status.textContent = "Loading weekly results…";
      try{
        const [values, playerStats] = await Promise.all([
          fetchRange("A1:CH500"),
          fetchRange("A1:M500", PLAYER_STATS_SHEET),
        ]);
        const weeks = parseWeeks(values).sort((a, b) => getWeekSortValue(a) - getWeekSortValue(b));
        currentWeeks = weeks;
        playerStatsMap = buildPlayerStatsMap(playerStats);
        currentWeekIndex = Math.max(weeks.length - 1, 0);
        status.remove();
        setupWindToggle();
        setupScoreModal();
        renderWeek(weeks, currentWeekIndex);
      }catch(err){
        status.textContent = "Unable to load weekly results.";
        console.error(err);
      }
    }

    let currentWeekIndex = 0;
    let playerStatsMap = new Map();
    load();
    setInterval(load, REFRESH_MS);
  </script>
</body>
</html>
